import { BigNumber } from "bignumber.js"
import moment from "moment"
require("dotenv").config()

export async function getValue(raw, decimals) {
  let unit = new BigNumber(10).pow(parseInt(decimals))
  return new BigNumber(raw).div(unit).toNumber()
}

let wallets = [
  {
    lastModifiedOn: "2021-03-16T12:10:59.160Z",
    createdOn: "2021-03-16T10:41:28.007Z",
    _id: "60508b58fc38e806b26e56bc",
    category: "CEX",
    label: "Binance8",
    currentBalance: 1905396.555,
    address: "0xf977814e90da44bfa03b6295a0616a897441acec",
    balances: {
      "1616784906092": "9420463.308",
      "1616781306092": "8451943.724",
      "1616777706092": "8163261.890",
      "1616774106092": "500354.028",
      "1616770506092": "4958610.214",
      "1616766906092": "9946806.975",
      "1616763306092": "3576560.178",
      "1616759706092": "5955068.753",
      "1616756106092": "8281528.436",
      "1616752506092": "1868038.062",
      "1616748906092": "6301902.800",
      "1616745306092": "2523965.733",
      "1616741706092": "6497963.618",
      "1616738106092": "6753037.216",
      "1616734506092": "5596588.421",
      "1616730906092": "3862163.403",
      "1616727306092": "4303502.250",
      "1616723706092": "9386588.309",
      "1616720106092": "943923.499",
      "1616716506092": "496675.855",
      "1616712906092": "5354593.256",
      "1616709306092": "7967450.395",
      "1616705706092": "5378647.120",
      "1616702106092": "3774838.791",
      "1616698506092": "424788.052",
      "1616694906092": "2614764.336",
      "1616691306092": "3646012.309",
      "1616687706092": "8717634.367",
      "1616684106092": "8367615.244",
      "1616680506092": "5093318.902",
      "1616676906092": "7503777.667",
      "1616673306092": "7136042.727",
      "1616669706092": "3718417.377",
      "1616666106092": "4103665.647",
      "1616662506092": "5846126.713",
      "1616658906092": "7501896.981",
      "1616655306092": "303627.409",
      "1616651706092": "414770.573",
      "1616648106092": "3684150.433",
      "1616644506092": "1276367.799",
      "1616640906092": "4220438.918",
      "1616637306092": "4273145.022",
      "1616633706092": "6132667.534",
      "1616630106092": "5873218.312",
      "1616626506092": "5862854.291",
      "1616622906092": "6423661.174",
      "1616619306092": "7054255.789",
      "1616615706092": "3838536.939",
      "1616612106092": "8771880.017",
      "1616608506092": "7688981.867",
      "1616604906092": "1205460.080",
      "1616601306092": "3732170.119",
      "1616597706092": "1425939.904",
      "1616594106092": "1800778.086",
      "1616590506092": "1031733.505",
      "1616586906092": "3412726.419",
      "1616583306092": "1213322.726",
      "1616579706092": "3262451.262",
      "1616576106092": "6641688.832",
      "1616572506092": "6356393.321",
      "1616568906092": "3103448.378",
      "1616565306092": "9708009.537",
      "1616561706092": "8102093.013",
      "1616558106092": "2384484.847",
      "1616554506092": "5389049.495",
      "1616550906092": "37495.141",
      "1616547306092": "6976979.714",
      "1616543706092": "6117251.125",
      "1616540106092": "6960882.777",
      "1616536506092": "9158048.431",
      "1616532906092": "8962666.036",
      "1616529306092": "2191465.800",
      "1616525706092": "2795218.193",
      "1616522106092": "3140172.069",
      "1616518506092": "4187627.272",
      "1616514906092": "7565843.786",
      "1616511306092": "2940995.722",
      "1616507706092": "2661064.432",
      "1616504106092": "3227989.183",
      "1616500506092": "1949375.105",
      "1616496906092": "9820578.264",
      "1616493306092": "1203822.731",
      "1616489706092": "7232270.744",
      "1616486106092": "7453593.800",
      "1616482506092": "3813431.424",
      "1616478906092": "1117197.009",
      "1616475306092": "632135.399",
      "1616471706092": "7438838.735",
      "1616468106092": "461653.649",
      "1616464506092": "2080754.075",
      "1616460906092": "6612960.694",
      "1616457306092": "3529929.964",
      "1616453706092": "1938466.438",
      "1616450106092": "6578451.195",
      "1616446506092": "3499253.831",
      "1616442906092": "838986.796",
      "1616439306092": "2092336.084",
      "1616435706092": "8559206.999",
      "1616432106092": "4027018.239",
      "1616428506092": "1431256.990",
      "1616424906092": "2335704.882",
      "1616421306092": "4298606.290",
      "1616417706092": "7865690.560",
      "1616414106092": "557057.630",
      "1616410506092": "2105672.284",
      "1616406906092": "7813965.556",
      "1616403306092": "4478406.791",
      "1616399706092": "3010042.006",
      "1616396106092": "5753891.810",
      "1616392506092": "8441847.190",
      "1616388906092": "3124010.191",
      "1616385306092": "9994664.891",
      "1616381706092": "4867303.625",
      "1616378106092": "29215.254",
      "1616374506092": "2482724.516",
      "1616370906092": "6068421.197",
      "1616367306092": "1703844.912",
      "1616363706092": "1451426.235",
      "1616360106092": "8435249.177",
      "1616356506092": "3157254.591",
      "1616352906092": "2164413.002",
      "1616349306092": "5153101.549",
      "1616345706092": "2289356.068",
      "1616342106092": "2217409.578",
      "1616338506092": "6627355.515",
      "1616334906092": "1186457.860",
      "1616331306092": "2753443.616",
      "1616327706092": "9539945.182",
      "1616324106092": "4534753.731",
      "1616320506092": "8046053.263",
      "1616316906092": "1281039.822",
      "1616313306092": "7850562.978",
      "1616309706092": "4540181.495",
      "1616306106092": "853848.991",
      "1616302506092": "4447176.235",
      "1616298906092": "9039662.445",
      "1616295306092": "8019655.753",
      "1616291706092": "7369134.480",
      "1616288106092": "8808893.039",
      "1616284506092": "1957086.244",
      "1616280906092": "4193351.308",
      "1616277306092": "1061705.206",
      "1616273706092": "6804230.200",
      "1616270106092": "2739268.148",
      "1616266506092": "7262795.133",
      "1616262906092": "6896852.571",
      "1616259306092": "9294017.600",
      "1616255706092": "4865680.648",
      "1616252106092": "7598368.874",
      "1616248506092": "6230169.052",
      "1616244906092": "893001.896",
      "1616241306092": "7877446.776",
      "1616237706092": "6529774.772",
      "1616234106092": "7578452.710",
      "1616230506092": "7057838.936",
      "1616226906092": "2865496.006",
      "1616223306092": "3156408.920",
      "1616219706092": "6341138.520",
      "1616216106092": "8075559.744",
      "1616212506092": "5191906.883",
      "1616208906092": "8333240.592",
      "1616205306092": "7646116.380",
      "1616201706092": "3059014.244",
      "1616198106092": "6711814.273",
      "1616194506092": "9956318.285",
      "1616190906092": "6151916.628",
      "1616187306092": "7388532.304",
      "1616183706092": "5468618.366",
      "1616180106092": "1557582.360",
      "1616176506092": "2498194.303",
      "1616172906092": "4271518.188",
      "1616169306092": "708042.539",
      "1616165706092": "316681.229",
      "1616162106092": "6003495.060",
      "1616158506092": "9273041.398",
      "1616154906092": "4293979.563",
      "1616151306092": "933098.233",
      "1616147706092": "2638793.397",
      "1616144106092": "1671586.021"
    },
    __v: 0
  },
  {
    lastModifiedOn: "2021-03-16T12:10:59.343Z",
    createdOn: "2021-03-16T10:41:28.681Z",
    _id: "60508b58fc38e806b26e56bd",
    category: "CEX",
    label: "Binance7",
    currentBalance: 2072742.555,
    address: "0xbe0eb53f46cd790cd13851d5eff43d12404d33e8",
    balances: {
      "1616784934109": "2814593.963",
      "1616781334109": "2959754.036",
      "1616777734109": "5628762.923",
      "1616774134109": "8315580.562",
      "1616770534109": "3875340.668",
      "1616766934109": "9640892.649",
      "1616763334109": "3993970.550",
      "1616759734109": "3103066.553",
      "1616756134109": "2755222.431",
      "1616752534109": "666123.504",
      "1616748934109": "213247.281",
      "1616745334109": "8892100.982",
      "1616741734109": "5275095.896",
      "1616738134109": "5762088.239",
      "1616734534109": "2060077.411",
      "1616730934109": "2160134.079",
      "1616727334109": "7482561.782",
      "1616723734109": "6685436.780",
      "1616720134109": "3277951.885",
      "1616716534109": "7896940.605",
      "1616712934109": "205907.285",
      "1616709334109": "3592939.225",
      "1616705734109": "1038426.374",
      "1616702134109": "6821523.700",
      "1616698534109": "6172815.660",
      "1616694934109": "8425189.056",
      "1616691334109": "6500858.456",
      "1616687734109": "4690796.944",
      "1616684134109": "5549786.363",
      "1616680534109": "5727536.079",
      "1616676934109": "8024912.302",
      "1616673334109": "6609491.687",
      "1616669734109": "6698193.015",
      "1616666134109": "6067213.200",
      "1616662534109": "9581414.455",
      "1616658934109": "5126215.470",
      "1616655334109": "4724453.779",
      "1616651734109": "9315546.850",
      "1616648134109": "4048770.565",
      "1616644534109": "4406001.499",
      "1616640934109": "1228356.393",
      "1616637334109": "111686.526",
      "1616633734109": "4579814.019",
      "1616630134109": "6888279.625",
      "1616626534109": "3210272.543",
      "1616622934109": "2313680.090",
      "1616619334109": "9710314.077",
      "1616615734109": "2332786.889",
      "1616612134109": "6462139.635",
      "1616608534109": "4935359.002",
      "1616604934109": "7456972.775",
      "1616601334109": "5784168.469",
      "1616597734109": "9097037.075",
      "1616594134109": "6054963.156",
      "1616590534109": "7172986.313",
      "1616586934109": "1137777.586",
      "1616583334109": "8822123.456",
      "1616579734109": "4248085.146",
      "1616576134109": "9455870.712",
      "1616572534109": "4755458.741",
      "1616568934109": "6432751.372",
      "1616565334109": "8755515.072",
      "1616561734109": "7993428.835",
      "1616558134109": "8039298.207",
      "1616554534109": "5317117.537",
      "1616550934109": "9392339.827",
      "1616547334109": "63068.311",
      "1616543734109": "1603760.607",
      "1616540134109": "6344885.226",
      "1616536534109": "5064497.041",
      "1616532934109": "999550.542",
      "1616529334109": "9292520.485",
      "1616525734109": "9828152.171",
      "1616522134109": "2838864.016",
      "1616518534109": "3530990.970",
      "1616514934109": "7440773.921",
      "1616511334109": "1640011.910",
      "1616507734109": "4795951.785",
      "1616504134109": "366003.793",
      "1616500534109": "3510874.845",
      "1616496934109": "2543640.047",
      "1616493334109": "1134009.690",
      "1616489734109": "5205460.323",
      "1616486134109": "1451231.555",
      "1616482534109": "2713480.175",
      "1616478934109": "8696727.447",
      "1616475334109": "5108681.120",
      "1616471734109": "8594196.774",
      "1616468134109": "4169905.565",
      "1616464534109": "4631778.462",
      "1616460934109": "8712770.111",
      "1616457334109": "7374038.024",
      "1616453734109": "8155579.666",
      "1616450134109": "8922640.441",
      "1616446534109": "846019.957",
      "1616442934109": "9678585.855",
      "1616439334109": "4551045.384",
      "1616435734109": "9127835.552",
      "1616432134109": "4231194.197",
      "1616428534109": "107678.757",
      "1616424934109": "8802145.360",
      "1616421334109": "6399399.405",
      "1616417734109": "1541197.798",
      "1616414134109": "3151892.068",
      "1616410534109": "3073779.759",
      "1616406934109": "6922744.428",
      "1616403334109": "4773506.121",
      "1616399734109": "8612701.847",
      "1616396134109": "4795737.446",
      "1616392534109": "3771758.380",
      "1616388934109": "1783990.516",
      "1616385334109": "4111430.199",
      "1616381734109": "4708080.990",
      "1616378134109": "7446589.687",
      "1616374534109": "7483514.004",
      "1616370934109": "8191638.816",
      "1616367334109": "806251.578",
      "1616363734109": "7064441.802",
      "1616360134109": "6596454.264",
      "1616356534109": "3415467.026",
      "1616352934109": "1461699.543",
      "1616349334109": "6496415.255",
      "1616345734109": "5422056.093",
      "1616342134109": "484319.237",
      "1616338534109": "4313625.128",
      "1616334934109": "5570914.977",
      "1616331334109": "9323436.380",
      "1616327734109": "7606674.874",
      "1616324134109": "7565762.477",
      "1616320534109": "6723978.946",
      "1616316934109": "8689507.202",
      "1616313334109": "405772.762",
      "1616309734109": "8366781.075",
      "1616306134109": "484922.244",
      "1616302534109": "654528.333",
      "1616298934109": "9064526.808",
      "1616295334109": "9893629.726",
      "1616291734109": "9179579.248",
      "1616288134109": "2527718.359",
      "1616284534109": "9584681.820",
      "1616280934109": "2858772.791",
      "1616277334109": "7418623.462",
      "1616273734109": "5519558.598",
      "1616270134109": "3273658.161",
      "1616266534109": "4885721.436",
      "1616262934109": "1302493.766",
      "1616259334109": "9496784.741",
      "1616255734109": "5792988.857",
      "1616252134109": "3760077.662",
      "1616248534109": "1803409.559",
      "1616244934109": "9533601.352",
      "1616241334109": "3047845.983",
      "1616237734109": "1446498.118",
      "1616234134109": "2543312.645",
      "1616230534109": "9336096.855",
      "1616226934109": "4971800.208",
      "1616223334109": "7782884.601",
      "1616219734109": "1752858.326",
      "1616216134109": "3595779.024",
      "1616212534109": "7227433.376",
      "1616208934109": "8239671.558",
      "1616205334109": "7386810.333",
      "1616201734109": "9163838.634",
      "1616198134109": "5287169.084",
      "1616194534109": "4442103.055",
      "1616190934109": "8121357.146",
      "1616187334109": "9223721.713",
      "1616183734109": "1959105.228",
      "1616180134109": "6451567.734",
      "1616176534109": "4856359.939",
      "1616172934109": "555630.591",
      "1616169334109": "400392.275",
      "1616165734109": "751774.319",
      "1616162134109": "866005.471",
      "1616158534109": "6132540.229",
      "1616154934109": "8475968.746",
      "1616151334109": "5449116.756",
      "1616147734109": "1564896.661",
      "1616144134109": "8559212.931"
    },
    __v: 0
  },
  {
    lastModifiedOn: "2021-03-16T12:10:59.526Z",
    createdOn: "2021-03-16T10:41:28.953Z",
    _id: "60508b59fc38e806b26e56be",
    currentBalance: 2627826.991,
    category: "CEX",
    label: "Bittrex",
    address: "0xfbb1b73c4f0bda4f67dca266ce6ef42f520fbb98",
    balances: {
      "1616784950737": "5055159.507",
      "1616781350737": "9809504.547",
      "1616777750737": "9782691.629",
      "1616774150737": "5383737.663",
      "1616770550737": "998100.714",
      "1616766950737": "5203409.156",
      "1616763350737": "2377802.207",
      "1616759750737": "2465618.228",
      "1616756150737": "8307258.734",
      "1616752550737": "4466346.054",
      "1616748950737": "4091666.742",
      "1616745350737": "6407980.507",
      "1616741750737": "4522802.544",
      "1616738150737": "2543825.720",
      "1616734550737": "7668973.244",
      "1616730950737": "653771.066",
      "1616727350737": "2476766.024",
      "1616723750737": "5485254.078",
      "1616720150737": "6572844.520",
      "1616716550737": "3173526.744",
      "1616712950737": "5054085.449",
      "1616709350737": "9062538.467",
      "1616705750737": "8959982.971",
      "1616702150737": "8344373.804",
      "1616698550737": "5078522.759",
      "1616694950737": "2655532.829",
      "1616691350737": "3511084.218",
      "1616687750737": "9635225.993",
      "1616684150737": "6556167.478",
      "1616680550737": "6734300.838",
      "1616676950737": "5221831.214",
      "1616673350737": "1373328.778",
      "1616669750737": "4111098.898",
      "1616666150737": "2167416.736",
      "1616662550737": "6542796.000",
      "1616658950737": "8321258.622",
      "1616655350737": "9439596.446",
      "1616651750737": "2766564.826",
      "1616648150737": "3782801.697",
      "1616644550737": "6598558.063",
      "1616640950737": "2928056.723",
      "1616637350737": "2430371.509",
      "1616633750737": "3770434.990",
      "1616630150737": "1680873.589",
      "1616626550737": "2690425.505",
      "1616622950737": "7157092.653",
      "1616619350737": "5841469.918",
      "1616615750737": "7543158.638",
      "1616612150737": "7594727.799",
      "1616608550737": "9787703.814",
      "1616604950737": "7670223.040",
      "1616601350737": "7657616.076",
      "1616597750737": "5088518.874",
      "1616594150737": "6293345.576",
      "1616590550737": "131355.403",
      "1616586950737": "1690575.836",
      "1616583350737": "5297997.155",
      "1616579750737": "7055994.994",
      "1616576150737": "5080272.302",
      "1616572550737": "5378650.754",
      "1616568950737": "5662447.698",
      "1616565350737": "4005876.130",
      "1616561750737": "2275721.663",
      "1616558150737": "3975660.273",
      "1616554550737": "7980666.909",
      "1616550950737": "2985639.110",
      "1616547350737": "7805211.829",
      "1616543750737": "138367.929",
      "1616540150737": "7433713.051",
      "1616536550737": "3053047.586",
      "1616532950737": "2545289.612",
      "1616529350737": "2645797.303",
      "1616525750737": "825298.362",
      "1616522150737": "6266227.739",
      "1616518550737": "4742590.272",
      "1616514950737": "4401320.798",
      "1616511350737": "1155527.784",
      "1616507750737": "164932.497",
      "1616504150737": "8032287.569",
      "1616500550737": "1986473.454",
      "1616496950737": "2994804.328",
      "1616493350737": "8398922.385",
      "1616489750737": "4986192.970",
      "1616486150737": "9298275.442",
      "1616482550737": "8426278.311",
      "1616478950737": "7700690.410",
      "1616475350737": "3126387.134",
      "1616471750737": "2523605.402",
      "1616468150737": "7856316.137",
      "1616464550737": "118995.256",
      "1616460950737": "6301148.636",
      "1616457350737": "6280263.670",
      "1616453750737": "8154476.237",
      "1616450150737": "8451711.653",
      "1616446550737": "8267684.900",
      "1616442950737": "1003421.689",
      "1616439350737": "7727809.561",
      "1616435750737": "8346307.468",
      "1616432150737": "7138683.233",
      "1616428550737": "7133817.807",
      "1616424950737": "9288548.338",
      "1616421350737": "5344155.817",
      "1616417750737": "8870508.276",
      "1616414150737": "7180064.800",
      "1616410550737": "8212909.842",
      "1616406950737": "4953474.386",
      "1616403350737": "4377932.849",
      "1616399750737": "6906328.489",
      "1616396150737": "502627.540",
      "1616392550737": "8501781.687",
      "1616388950737": "5299999.405",
      "1616385350737": "1145489.899",
      "1616381750737": "780549.659",
      "1616378150737": "3015703.218",
      "1616374550737": "2416989.009",
      "1616370950737": "6335018.600",
      "1616367350737": "4528781.232",
      "1616363750737": "8973104.765",
      "1616360150737": "5875831.460",
      "1616356550737": "9976197.713",
      "1616352950737": "7222511.407",
      "1616349350737": "9727171.363",
      "1616345750737": "3037659.007",
      "1616342150737": "8544351.347",
      "1616338550737": "5482296.645",
      "1616334950737": "7197535.039",
      "1616331350737": "8073361.362",
      "1616327750737": "4682274.307",
      "1616324150737": "6053662.246",
      "1616320550737": "7517098.915",
      "1616316950737": "8077899.043",
      "1616313350737": "8490426.598",
      "1616309750737": "6144552.752",
      "1616306150737": "9849468.538",
      "1616302550737": "7389942.878",
      "1616298950737": "4918640.518",
      "1616295350737": "7401505.645",
      "1616291750737": "5501921.493",
      "1616288150737": "5834437.903",
      "1616284550737": "6474276.213",
      "1616280950737": "2501634.136",
      "1616277350737": "9845504.935",
      "1616273750737": "767037.486",
      "1616270150737": "9147766.933",
      "1616266550737": "9270629.915",
      "1616262950737": "2365441.054",
      "1616259350737": "3205109.827",
      "1616255750737": "8882051.362",
      "1616252150737": "7568269.009",
      "1616248550737": "196475.797",
      "1616244950737": "134651.948",
      "1616241350737": "5631344.814",
      "1616237750737": "7269450.689",
      "1616234150737": "6277859.944",
      "1616230550737": "7376353.652",
      "1616226950737": "4828057.481",
      "1616223350737": "3135752.052",
      "1616219750737": "1974108.663",
      "1616216150737": "743321.392",
      "1616212550737": "9199853.011",
      "1616208950737": "9065519.336",
      "1616205350737": "826272.782",
      "1616201750737": "1336680.708",
      "1616198150737": "1754545.121",
      "1616194550737": "4415456.493",
      "1616190950737": "6210784.171",
      "1616187350737": "1879488.226",
      "1616183750737": "7736506.978",
      "1616180150737": "424724.269",
      "1616176550737": "1179556.978",
      "1616172950737": "6926627.652",
      "1616169350737": "7724647.147",
      "1616165750737": "270128.282",
      "1616162150737": "7304363.824",
      "1616158550737": "5231234.092",
      "1616154950737": "6862658.333",
      "1616151350737": "8428792.300",
      "1616147750737": "4990361.293",
      "1616144150737": "9434477.940"
    },
    __v: 0
  },
  {
    lastModifiedOn: "2021-03-16T12:10:59.526Z",
    createdOn: "2021-03-16T10:41:28.953Z",
    currentBalance: 6526141.912,
    _id: "60508b59fc38e806b26e56be",
    category: "CEX",
    label: "OCEAN-ETH",
    address: "0xfbb1b73c4f0bda4f67dca266ce6ef42f520fbb98",
    balances: {
      "1616784977999": "9740204.701",
      "1616781377999": "5244628.644",
      "1616777777999": "6749024.209",
      "1616774177999": "1791421.253",
      "1616770577999": "6770680.146",
      "1616766977999": "4940720.780",
      "1616763377999": "5524022.858",
      "1616759777999": "9292157.731",
      "1616756177999": "5206561.946",
      "1616752577999": "6174105.436",
      "1616748977999": "4622005.060",
      "1616745377999": "5486378.340",
      "1616741777999": "341857.895",
      "1616738177999": "7857508.426",
      "1616734577999": "4373345.325",
      "1616730977999": "4786054.284",
      "1616727377999": "5944451.772",
      "1616723777999": "6879600.976",
      "1616720177999": "6860612.068",
      "1616716577999": "444965.439",
      "1616712977999": "3783600.331",
      "1616709377999": "6266688.921",
      "1616705777999": "1688992.751",
      "1616702177999": "7634992.774",
      "1616698577999": "3661361.514",
      "1616694977999": "8503606.616",
      "1616691377999": "816949.286",
      "1616687777999": "3596692.230",
      "1616684177999": "2879322.741",
      "1616680577999": "8549698.170",
      "1616676977999": "940858.762",
      "1616673377999": "6022.761",
      "1616669777999": "6185762.036",
      "1616666177999": "2227338.689",
      "1616662577999": "3205723.489",
      "1616658977999": "560851.524",
      "1616655377999": "9683177.190",
      "1616651777999": "7272598.510",
      "1616648177999": "2363839.117",
      "1616644577999": "3907744.165",
      "1616640977999": "9398884.437",
      "1616637377999": "4574875.927",
      "1616633777999": "8675779.800",
      "1616630177999": "3940203.195",
      "1616626577999": "195916.309",
      "1616622977999": "1910467.811",
      "1616619377999": "5099401.958",
      "1616615777999": "1775330.457",
      "1616612177999": "2872218.932",
      "1616608577999": "308897.467",
      "1616604977999": "1697198.669",
      "1616601377999": "7480382.745",
      "1616597777999": "6769208.173",
      "1616594177999": "5212091.964",
      "1616590577999": "2124421.140",
      "1616586977999": "9473213.236",
      "1616583377999": "7781567.637",
      "1616579777999": "9466401.779",
      "1616576177999": "1436625.653",
      "1616572577999": "7841179.906",
      "1616568977999": "6437659.245",
      "1616565377999": "3026715.355",
      "1616561777999": "2247203.539",
      "1616558177999": "4755421.198",
      "1616554577999": "4932814.535",
      "1616550977999": "3794114.183",
      "1616547377999": "7494332.662",
      "1616543777999": "4609229.456",
      "1616540177999": "4111875.825",
      "1616536577999": "7765048.721",
      "1616532977999": "3326135.975",
      "1616529377999": "3825701.831",
      "1616525777999": "499347.459",
      "1616522177999": "532792.371",
      "1616518577999": "2340908.909",
      "1616514977999": "27777.800",
      "1616511377999": "1274915.528",
      "1616507777999": "3827573.362",
      "1616504177999": "612608.425",
      "1616500577999": "2232041.777",
      "1616496977999": "7162029.092",
      "1616493377999": "7315999.564",
      "1616489777999": "4772335.964",
      "1616486177999": "2222623.246",
      "1616482577999": "9378458.506",
      "1616478977999": "8693317.049",
      "1616475377999": "3419442.862",
      "1616471777999": "7568690.057",
      "1616468177999": "8938583.679",
      "1616464577999": "7345617.257",
      "1616460977999": "1969700.014",
      "1616457377999": "1789387.732",
      "1616453777999": "8524949.974",
      "1616450177999": "9715779.027",
      "1616446577999": "2740242.215",
      "1616442977999": "9944821.232",
      "1616439377999": "4683589.035",
      "1616435777999": "6629093.810",
      "1616432177999": "6875473.851",
      "1616428577999": "3792245.092",
      "1616424977999": "649425.234",
      "1616421377999": "6915706.412",
      "1616417777999": "2069110.063",
      "1616414177999": "8372151.937",
      "1616410577999": "9934366.078",
      "1616406977999": "3734272.377",
      "1616403377999": "4443234.443",
      "1616399777999": "9141072.303",
      "1616396177999": "3599814.448",
      "1616392577999": "8988327.421",
      "1616388977999": "8809911.419",
      "1616385377999": "8162515.082",
      "1616381777999": "358934.001",
      "1616378177999": "2282130.692",
      "1616374577999": "5212149.111",
      "1616370977999": "8621734.753",
      "1616367377999": "6712322.139",
      "1616363777999": "5794907.620",
      "1616360177999": "880682.228",
      "1616356577999": "583907.000",
      "1616352977999": "3384870.170",
      "1616349377999": "6285537.912",
      "1616345777999": "315783.316",
      "1616342177999": "637986.638",
      "1616338577999": "8002327.541",
      "1616334977999": "5570769.090",
      "1616331377999": "6879677.694",
      "1616327777999": "1172291.060",
      "1616324177999": "3737981.393",
      "1616320577999": "9115790.809",
      "1616316977999": "2828323.536",
      "1616313377999": "5410854.717",
      "1616309777999": "1481141.060",
      "1616306177999": "7765330.870",
      "1616302577999": "5336497.592",
      "1616298977999": "6414020.243",
      "1616295377999": "9531181.136",
      "1616291777999": "5679153.520",
      "1616288177999": "4862414.773",
      "1616284577999": "8768210.519",
      "1616280977999": "2578763.839",
      "1616277377999": "6686321.754",
      "1616273777999": "4944280.497",
      "1616270177999": "4044762.201",
      "1616266577999": "2538916.886",
      "1616262977999": "9151447.932",
      "1616259377999": "4637610.645",
      "1616255777999": "8033162.660",
      "1616252177999": "7134786.996",
      "1616248577999": "6948872.543",
      "1616244977999": "670365.494",
      "1616241377999": "8173586.635",
      "1616237777999": "7156289.726",
      "1616234177999": "4126862.898",
      "1616230577999": "4092832.618",
      "1616226977999": "6759105.698",
      "1616223377999": "2378359.638",
      "1616219777999": "7719118.946",
      "1616216177999": "4075459.399",
      "1616212577999": "7472883.439",
      "1616208977999": "7110648.625",
      "1616205377999": "6290173.059",
      "1616201777999": "3206361.986",
      "1616198177999": "8972974.672",
      "1616194577999": "29122.319",
      "1616190977999": "34837.852",
      "1616187377999": "1745931.885",
      "1616183777999": "1257927.382",
      "1616180177999": "6324963.089",
      "1616176577999": "5778891.064",
      "1616172977999": "2965656.991",
      "1616169377999": "4918277.551",
      "1616165777999": "337331.430",
      "1616162177999": "8350485.024",
      "1616158577999": "2680551.361",
      "1616154977999": "9188764.686",
      "1616151377999": "2210187.112",
      "1616147777999": "1165416.319",
      "1616144177999": "1307581.974"
    },
    __v: 0
  },
  {
    lastModifiedOn: "2021-03-16T15:26:56.273Z",
    createdOn: "2021-03-16T15:26:56.273Z",
    _id: "6050ce40b363310ce4cc3116",
    category: "DEX",
    label: "OCEAN-WETH",
    address: "0x9b7dad79fc16106b47a3dab791f389c167e15eb0",
    group: "Uniswap",
    balances: {
      "1616785155847": "9040163.485",
      "1616781555847": "2200234.602",
      "1616777955847": "2247827.672",
      "1616774355847": "5039979.790",
      "1616770755847": "5484111.007",
      "1616767155847": "5719511.996",
      "1616763555847": "4563496.624",
      "1616759955847": "960491.697",
      "1616756355847": "8745302.884",
      "1616752755847": "8001387.386",
      "1616749155847": "6717631.514",
      "1616745555847": "6883489.565",
      "1616741955847": "267875.225",
      "1616738355847": "1637026.327",
      "1616734755847": "1015355.708",
      "1616731155847": "2338613.587",
      "1616727555847": "7305576.586",
      "1616723955847": "5986287.979",
      "1616720355847": "4634291.641",
      "1616716755847": "5364623.563",
      "1616713155847": "1451455.266",
      "1616709555847": "2717998.724",
      "1616705955847": "6484025.135",
      "1616702355847": "5059012.946",
      "1616698755847": "4087939.838",
      "1616695155847": "3353630.975",
      "1616691555847": "9838907.806",
      "1616687955847": "6459559.218",
      "1616684355847": "9738617.328",
      "1616680755847": "4236565.655",
      "1616677155847": "5657491.530",
      "1616673555847": "3691957.935",
      "1616669955847": "144293.648",
      "1616666355847": "3381877.141",
      "1616662755847": "484291.542",
      "1616659155847": "7899475.198",
      "1616655555847": "3280716.075",
      "1616651955847": "2737387.701",
      "1616648355847": "7894977.441",
      "1616644755847": "5738511.168",
      "1616641155847": "5434958.043",
      "1616637555847": "6941505.926",
      "1616633955847": "1199587.185",
      "1616630355847": "965725.304",
      "1616626755847": "7904706.096",
      "1616623155847": "6284033.747",
      "1616619555847": "8467487.101",
      "1616615955847": "3439610.173",
      "1616612355847": "9303640.506",
      "1616608755847": "2748100.359",
      "1616605155847": "3929653.031",
      "1616601555847": "6602463.046",
      "1616597955847": "8145410.463",
      "1616594355847": "8910864.321",
      "1616590755847": "8716678.220",
      "1616587155847": "6281959.559",
      "1616583555847": "7332159.335",
      "1616579955847": "5905676.473",
      "1616576355847": "9340046.852",
      "1616572755847": "7405025.635",
      "1616569155847": "9210303.273",
      "1616565555847": "1757039.911",
      "1616561955847": "7650261.631",
      "1616558355847": "139944.180",
      "1616554755847": "8989170.091",
      "1616551155847": "6848937.639",
      "1616547555847": "1605872.355",
      "1616543955847": "6980325.234",
      "1616540355847": "3598483.517",
      "1616536755847": "1366975.928",
      "1616533155847": "813704.674",
      "1616529555847": "8115755.780",
      "1616525955847": "7911435.431",
      "1616522355847": "7692022.037",
      "1616518755847": "3492081.298",
      "1616515155847": "2058095.192",
      "1616511555847": "4957937.164",
      "1616507955847": "8827877.551",
      "1616504355847": "701356.622",
      "1616500755847": "5298095.520",
      "1616497155847": "6578904.319",
      "1616493555847": "1569277.110",
      "1616489955847": "4749896.514",
      "1616486355847": "1998907.507",
      "1616482755847": "4618681.366",
      "1616479155847": "9873600.256",
      "1616475555847": "5398451.083",
      "1616471955847": "2937740.389",
      "1616468355847": "6339942.393",
      "1616464755847": "8050102.655",
      "1616461155847": "8297052.651",
      "1616457555847": "4590724.166",
      "1616453955847": "500018.081",
      "1616450355847": "6432906.469",
      "1616446755847": "7854552.041",
      "1616443155847": "3190919.528",
      "1616439555847": "9627852.373",
      "1616435955847": "5137154.125",
      "1616432355847": "5699987.348",
      "1616428755847": "9706023.884",
      "1616425155847": "1396981.901",
      "1616421555847": "8113876.995",
      "1616417955847": "428020.191",
      "1616414355847": "8986942.274",
      "1616410755847": "4495671.498",
      "1616407155847": "7085299.610",
      "1616403555847": "3378273.341",
      "1616399955847": "1984067.642",
      "1616396355847": "6331795.155",
      "1616392755847": "8007967.962",
      "1616389155847": "9187044.221",
      "1616385555847": "5143223.562",
      "1616381955847": "1917288.791",
      "1616378355847": "5175105.209",
      "1616374755847": "1839162.492",
      "1616371155847": "1854830.503",
      "1616367555847": "6662140.749",
      "1616363955847": "3291333.091",
      "1616360355847": "7153238.134",
      "1616356755847": "5378049.772",
      "1616353155847": "6282644.477",
      "1616349555847": "7216128.254",
      "1616345955847": "825078.589",
      "1616342355847": "2762938.118",
      "1616338755847": "4898442.951",
      "1616335155847": "131777.746",
      "1616331555847": "4657566.627",
      "1616327955847": "2095282.374",
      "1616324355847": "7823036.974",
      "1616320755847": "9371370.495",
      "1616317155847": "2757605.489",
      "1616313555847": "9299086.815",
      "1616309955847": "5454496.328",
      "1616306355847": "9290587.113",
      "1616302755847": "7502953.599",
      "1616299155847": "6753494.303",
      "1616295555847": "5461887.262",
      "1616291955847": "2868631.687",
      "1616288355847": "1879323.958",
      "1616284755847": "6753657.157",
      "1616281155847": "8766724.792",
      "1616277555847": "2192258.831",
      "1616273955847": "8144254.195",
      "1616270355847": "5013011.042",
      "1616266755847": "8150207.842",
      "1616263155847": "3344089.957",
      "1616259555847": "3742209.182",
      "1616255955847": "7894186.671",
      "1616252355847": "7103326.667",
      "1616248755847": "2239666.086",
      "1616245155847": "5566587.202",
      "1616241555847": "6217537.791",
      "1616237955847": "6987998.029",
      "1616234355847": "8215406.259",
      "1616230755847": "6990615.843",
      "1616227155847": "2203040.530",
      "1616223555847": "9714401.334",
      "1616219955847": "4823668.297",
      "1616216355847": "4423049.798",
      "1616212755847": "7380256.923",
      "1616209155847": "9619948.471",
      "1616205555847": "1772409.590",
      "1616201955847": "3572091.918",
      "1616198355847": "9203105.879",
      "1616194755847": "2185854.491",
      "1616191155847": "1364180.556",
      "1616187555847": "1658734.395",
      "1616183955847": "7740814.381",
      "1616180355847": "1706557.784",
      "1616176755847": "7351538.490",
      "1616173155847": "3271754.662",
      "1616169555847": "5341944.608",
      "1616165955847": "5066545.383",
      "1616162355847": "5211586.388",
      "1616158755847": "8158485.675",
      "1616155155847": "3316102.725",
      "1616151555847": "6578403.285",
      "1616147955847": "3586902.657",
      "1616144355847": "4721798.636"
    },
    currentBalance: 1905396.555,
    __v: 0
  },
  {
    lastModifiedOn: "2021-03-16T15:26:56.488Z",
    createdOn: "2021-03-16T15:26:56.488Z",
    _id: "6050ce40b363310ce4cc3117",
    category: "DEX",
    label: "OCEAN-BNT",
    address: "0x1d9d70233427ecb3167a302d67ba0ae3435cc87a",
    group: "Bancor",
    balances: {
      "1616785121181": "6112433.667",
      "1616781521181": "7624895.901",
      "1616777921181": "8005776.149",
      "1616774321181": "3728247.023",
      "1616770721181": "2406320.365",
      "1616767121181": "8548859.360",
      "1616763521181": "2053804.874",
      "1616759921181": "7674887.715",
      "1616756321181": "5446634.318",
      "1616752721181": "2386682.535",
      "1616749121181": "1397326.669",
      "1616745521181": "3847829.704",
      "1616741921181": "9892210.076",
      "1616738321181": "8893611.088",
      "1616734721181": "9639768.681",
      "1616731121181": "786546.484",
      "1616727521181": "8495306.089",
      "1616723921181": "3809680.180",
      "1616720321181": "6442202.239",
      "1616716721181": "7171692.582",
      "1616713121181": "127251.065",
      "1616709521181": "3052572.013",
      "1616705921181": "7911348.920",
      "1616702321181": "5862572.891",
      "1616698721181": "3682761.877",
      "1616695121181": "2320112.533",
      "1616691521181": "1268253.619",
      "1616687921181": "6094497.761",
      "1616684321181": "7046810.128",
      "1616680721181": "7827652.038",
      "1616677121181": "520064.850",
      "1616673521181": "2459070.570",
      "1616669921181": "7391428.318",
      "1616666321181": "9837294.250",
      "1616662721181": "8343966.427",
      "1616659121181": "5982150.716",
      "1616655521181": "8974691.768",
      "1616651921181": "8754209.989",
      "1616648321181": "113842.400",
      "1616644721181": "8805721.103",
      "1616641121181": "3387066.849",
      "1616637521181": "4418696.164",
      "1616633921181": "2519237.792",
      "1616630321181": "7701354.068",
      "1616626721181": "865043.955",
      "1616623121181": "6635945.860",
      "1616619521181": "5325915.932",
      "1616615921181": "691412.462",
      "1616612321181": "3684775.549",
      "1616608721181": "7030969.077",
      "1616605121181": "3161343.293",
      "1616601521181": "7323619.562",
      "1616597921181": "3285504.758",
      "1616594321181": "6998795.436",
      "1616590721181": "7424722.434",
      "1616587121181": "5021771.863",
      "1616583521181": "311662.830",
      "1616579921181": "1387512.820",
      "1616576321181": "7027384.446",
      "1616572721181": "8520628.451",
      "1616569121181": "9380241.605",
      "1616565521181": "2503971.284",
      "1616561921181": "5211916.080",
      "1616558321181": "4166019.990",
      "1616554721181": "9224496.972",
      "1616551121181": "2681085.782",
      "1616547521181": "5144597.194",
      "1616543921181": "5546663.637",
      "1616540321181": "7901010.812",
      "1616536721181": "5840624.827",
      "1616533121181": "6231488.384",
      "1616529521181": "9552091.798",
      "1616525921181": "1901396.377",
      "1616522321181": "6903692.425",
      "1616518721181": "7958000.585",
      "1616515121181": "8256886.875",
      "1616511521181": "3857524.142",
      "1616507921181": "1385716.409",
      "1616504321181": "9531779.634",
      "1616500721181": "9378851.494",
      "1616497121181": "465936.425",
      "1616493521181": "7372986.796",
      "1616489921181": "7036320.517",
      "1616486321181": "4821459.696",
      "1616482721181": "4562061.228",
      "1616479121181": "3063536.120",
      "1616475521181": "5061359.833",
      "1616471921181": "4697012.577",
      "1616468321181": "2959917.287",
      "1616464721181": "1904872.487",
      "1616461121181": "9315809.032",
      "1616457521181": "990785.806",
      "1616453921181": "7013848.512",
      "1616450321181": "3796422.214",
      "1616446721181": "1144688.496",
      "1616443121181": "1218243.070",
      "1616439521181": "9049839.788",
      "1616435921181": "5830047.351",
      "1616432321181": "5515277.556",
      "1616428721181": "1583622.630",
      "1616425121181": "5460559.101",
      "1616421521181": "9393377.992",
      "1616417921181": "9903053.765",
      "1616414321181": "3644189.431",
      "1616410721181": "2637691.891",
      "1616407121181": "7246470.662",
      "1616403521181": "5915524.253",
      "1616399921181": "2946087.626",
      "1616396321181": "1871024.822",
      "1616392721181": "9255659.538",
      "1616389121181": "6632320.951",
      "1616385521181": "3639350.663",
      "1616381921181": "7754660.774",
      "1616378321181": "2471967.460",
      "1616374721181": "8486169.709",
      "1616371121181": "2077463.371",
      "1616367521181": "7219658.040",
      "1616363921181": "912389.085",
      "1616360321181": "2027916.833",
      "1616356721181": "1351075.254",
      "1616353121181": "741299.531",
      "1616349521181": "4630073.863",
      "1616345921181": "5434673.018",
      "1616342321181": "9627152.296",
      "1616338721181": "9444746.201",
      "1616335121181": "3441310.707",
      "1616331521181": "215819.634",
      "1616327921181": "2349826.486",
      "1616324321181": "4938421.511",
      "1616320721181": "6221679.018",
      "1616317121181": "6802286.741",
      "1616313521181": "5931901.434",
      "1616309921181": "407865.779",
      "1616306321181": "5781097.272",
      "1616302721181": "2767055.367",
      "1616299121181": "7735321.438",
      "1616295521181": "2939713.859",
      "1616291921181": "1935851.312",
      "1616288321181": "3856750.918",
      "1616284721181": "8414099.924",
      "1616281121181": "2763941.969",
      "1616277521181": "6951835.460",
      "1616273921181": "5065774.959",
      "1616270321181": "7608445.984",
      "1616266721181": "7416443.266",
      "1616263121181": "9970657.809",
      "1616259521181": "9103393.882",
      "1616255921181": "3577104.429",
      "1616252321181": "8907353.372",
      "1616248721181": "736590.275",
      "1616245121181": "4874704.883",
      "1616241521181": "8587979.726",
      "1616237921181": "9732926.632",
      "1616234321181": "2207939.528",
      "1616230721181": "4954399.167",
      "1616227121181": "4368142.844",
      "1616223521181": "1572315.932",
      "1616219921181": "2008861.864",
      "1616216321181": "1719839.378",
      "1616212721181": "5287304.490",
      "1616209121181": "6905922.400",
      "1616205521181": "386227.213",
      "1616201921181": "6393311.958",
      "1616198321181": "7570733.533",
      "1616194721181": "5011427.539",
      "1616191121181": "7631019.314",
      "1616187521181": "3676987.103",
      "1616183921181": "1726467.223",
      "1616180321181": "384292.891",
      "1616176721181": "4996583.626",
      "1616173121181": "2526222.744",
      "1616169521181": "3368211.265",
      "1616165921181": "8522447.030",
      "1616162321181": "505578.107",
      "1616158721181": "9697664.122",
      "1616155121181": "9048354.579",
      "1616151521181": "2480301.613",
      "1616147921181": "6248321.761",
      "1616144321181": "3532764.934"
    },
    currentBalance: 10725040.12,
    __v: 0
  }
]

export async function processData(wallets) {
  let i = 0
  let liquidityCex = 0
  let liquidityDex = 0
  let data = {}
  data["cex"] = []
  data["dex"] = []

  while (i < wallets.length) {
    //calculate timeseries
    let results = await getTimeframes(wallets[i].balances)
    console.log(results)
    const { hour, day, week } = results
    wallets[i]["1h"] = wallets[i].balances[hour]
    wallets[i]["1d"] = wallets[i].balances[day]
    wallets[i]["1w"] = wallets[i].balances[week]

    if (wallets[i].category == "CEX") {
      data["cex"].push(wallets[i])
      liquidityCex += parseInt(wallets[i].currentBalance)
      console.log(liquidityCex)
    } else if (wallets[i].category == "DEX") {
      data["dex"].push(wallets[i])
      liquidityDex += parseInt(wallets[i].currentBalance)
    }
    i++
  }

  data.liquidityCex = liquidityCex
  data.liquidityDex = liquidityDex
  //console.log(JSON.stringify(data))
}

async function getTimeframes(data) {
  var hour = 0,
    day = 0,
    week = 0

  let keys = Object.keys(data)

  for (const timestamp of keys) {
    let diff = moment
      .duration(moment().diff(moment.unix(timestamp / 1000)))
      .asHours()

    console.log(timestamp)
    console.log("Hours Diff - ", diff)
    if (!hour && diff >= 1 && diff < 3) {
      hour = timestamp
    } else if (!day && diff >= 22 && diff < 48) {
      day = timestamp
    } else if (!week && diff >= 168 && diff < 192) {
      week = timestamp
    }
    //console.log({ hour, day, week })
  }
  return { hour, day, week }
}

processData(wallets)
